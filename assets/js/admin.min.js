!function(a){function b(){var b=a(".wpcw-widget .form").not(".wpcw-widget-hours .form");b.sortable({items:"> *:not(.not-sortable)",handle:".wpcw-widget-sortable-handle",containment:"parent",placeholder:"sortable-placeholder",axis:"y",tolerance:"pointer",forcePlaceholderSize:!0,cursorAt:{top:40},start:function(a,b){b.placeholder.height(b.helper.height())},stop:function(a,c){b.find(".customizer_update").val(c.item.index()).trigger("change")}})}function c(){a(".timeselect").timepicker({timeFormat:wpcw_admin.time_format});var b={changeTime:function(){var b=a(this);b.attr("value",b.val())},showPicker:function(){a(".ui-timepicker-wrapper").css("width",a(this).innerWidth()+"px")}};a(".timeselect").on("changeTime",b.changeTime),a(".timeselect").on("showTimepicker",b.showPicker)}a.fn.selectString=function(b){var c=a(this)[0],d=c.value.indexOf(b),e=d+b.length;if(c&&!(0>d))if(c.setSelectionRange)c.focus(),c.setSelectionRange(d,e);else if(c.createTextRange){var f=c.createTextRange();f.collapse(!0),f.moveEnd("character",e),f.moveStart("character",d),f.select()}else c.selectionStart&&(c.selectionStart=d,c.selectionEnd=e)};var d={$btn:null,$widget:null,$template:null,init:function(b){b.preventDefault();var c=d;return c.$btn=a(this),c.$widget=c.$btn.parents(".wpcw-widget"),c.$widget.find("."+c.$btn.data("key")).is(":animated")?!1:c.$btn.hasClass("inactive")?(c.$template=c.$widget.find(".default-fields"),c.$template=a(a.trim(c.$template.clone().html())),void c.add()):void c.remove()},add:function(){this.$btn.removeClass("inactive");var a=this.$btn.data();this.$template.addClass(a.key).find("label").prop("for",a.id),this.$template.find("input").prop("id",a.id).prop("name",a.name).prop("value",a.value),this.$template.find("label span.fa").prop("class",this.$btn.find("i").attr("class")),this.$template.find("label span.text").text(a.label),this.$template.hide().prependTo(this.$widget.find(".form")).stop(!0,!0).animate({height:"toggle",opacity:"toggle"},250),this.$template.find("input").selectString(a.select),this.update_customizer()},remove:function(){this.$btn.addClass("inactive"),this.$widget.find(".form ."+this.$btn.data("key")).stop(!0,!0).animate({height:"toggle",opacity:"toggle"},250,function(){a(this).remove()}),this.update_customizer()},update_customizer:function(){var a=this.$widget.find("div > div").length;this.$widget.find(".customizer_update").val(a).trigger("change")}},e={toggle:function(b){var d=a(this).closest(".day-row"),e=d.find(".day-row-container"),f=d.hasClass("status-closed");return e.is(":animated")?!1:(c(),e.slideToggle("fast"),a(this).prev("input").prop("checked",f),d.toggleClass("status-open",f).toggleClass("status-closed",!f),d.find(".timeselect").prop("disabled",!f).toggleClass("disabled",!f),void d.find("a.button").toggleClass("disabled",!f))},addBlock:function(b){b.preventDefault();var d=a(this);if(d.hasClass("disabled"))return!1;var f=d.closest(".time-block"),g=e.cloneTimeBlock(f,f.parent());g.find(".button").attr("data-action","remove"),g.find(".button span").removeClass("add"),d.hide(),c()},removeBlock:function(b){b.preventDefault();var c=a(this);if(c.hasClass("disabled"))return!1;var d=c.closest(".time-block");d.prev(".time-block").find(".button").show(),d.remove()},cloneTimeBlock:function(a,b){var c=parseInt(a.attr("data-time-block"),10),d=b.is(":empty")?0:parseInt(b.find(".time-block").last().attr("data-time-block"),10)+1,e=a.clone(),f=e.html(),g="\\[blocks\\]\\["+c+"\\]",h="[blocks]["+d+"]",i="-blocks-"+c,j="-blocks-"+d;return f=f.replace(new RegExp(g,"g"),h),f=f.replace(new RegExp(i,"g"),j),e=e.html(f),b.append(e),e.attr("data-time-block",d),e}};a(document).ready(function(a){c(),a(document).on("click",".wpcw-widget-social .icons a",d.init),a(document).on("click",".wpcw-widget-hours .day-row-top input, .wpcw-widget-hours .day-row-top label",e.toggle),a(document).on("click",'.wpcw-widget-hours .time-block .button[data-action="add"]',e.addBlock),a(document).on("click",'.wpcw-widget-hours .time-block .button[data-action="remove"]',e.removeBlock),a(document).on("wpcw.change",function(){b(),initialize_timepicker()}),a(document).on("click.widgets-toggle",b),a(document).on("widget-updated",function(){b(),c()})})}(jQuery);